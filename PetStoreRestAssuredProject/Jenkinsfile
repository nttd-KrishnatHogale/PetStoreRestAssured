pipeline {
    agent any

    environment {
        GITHUB_REPO = 'https://github.com/nttd-KrishnatHogale/PetStoreRestAssured.git'
                REPORTS_DIR = 'PetStoreRestAssuredProject/reports' // Path to your reports directory

//         MAVEN_HOME = tool name: 'Maven', type: 'hudson.tasks.Maven$MavenInstallation'
//         ALLURE_RESULTS_DIR = 'target/allure-results'
//         ALLURE_REPORT_DIR = 'target/allure-report'
//         ALLURE_DOWNLOAD_DIR = 'allure-reports'
    }
stages {
        stage('Checkout') {
            steps {
                git url: "${env.GITHUB_REPO}", branch: 'main'
            }
        }

        stage('Build') {
            steps {
            bat 'cd'
            dir('PetStoreRestAssuredProject') {
                                bat 'mvn clean test'
                            }
            }
        }

         stage('Archive Reports') {
                    steps {
                        catchError(buildResult: 'SUCCESS', stageResult: 'UNSTABLE') {
                            // Archive the contents of the reports directory
                            archiveArtifacts artifacts: "${REPORTS_DIR}/**", allowEmptyArchive: true
                        }
                    }
                }

}